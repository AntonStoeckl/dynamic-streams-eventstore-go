## Business Error Simulation Implementation
- **Created**: 2025-08-27 11:09
- **Priority**: Medium
- **Objective**: Add ability to trigger business rule violations intentionally for comprehensive load testing

## ðŸŽ¯ Problem Statement
The current simulation only tests successful operations and technical failures (timeouts, cancellations). We need realistic business error scenarios to test:
- Command handler error handling and failure rates
- System resilience under business rule violations
- Realistic error distribution patterns

## ðŸ“‹ Implementation Plan

### **Phase 1: Business Error Scenarios**
1. **ðŸ“š Book Lending Violations**
   - Attempt to lend already-lent books
   - Attempt to lend to readers with too many books
   - Attempt to lend non-existent books

2. **ðŸ“– Book Return Violations** 
   - Attempt to return books not borrowed by the reader
   - Attempt to return already-returned books
   - Attempt to return non-existent books

3. **ðŸ‘¥ Reader Registration Violations**
   - Attempt to register readers with duplicate IDs
   - Attempt to register with invalid reader data

4. **ðŸ“š Book Management Violations**
   - Attempt to add duplicate books to circulation
   - Attempt to remove books that are currently lent
   - Attempt to remove non-existent books

### **Phase 2: Error Rate Configuration**
1. **ðŸ”§ Tuning Constants**
   - `BusinessErrorProbability` - Base chance to trigger violations (e.g., 1-2%)
   - `ErrorTypeDistribution` - Relative frequency of different error types
   - `RealisticFailureRate` - Target overall failure rate for load testing

2. **ðŸ“Š Error Tracking**
   - Add `BusinessErrorCount` to BatchMetrics
   - Track error types and frequencies
   - Display in performance logging (`errs=X.X%`)

### **Phase 3: Actor Behavior Changes**
1. **ðŸŽ­ Reader Error Behaviors**
   - Occasionally attempt invalid lending operations
   - Try to return books they don't have
   - Natural error patterns based on reader state

2. **ðŸ“š Librarian Error Behaviors**
   - Attempt duplicate book additions
   - Try to remove books that are lent out
   - Realistic management operation failures

## ðŸš¨ Success Criteria
- âœ… Configurable business error rates (1-2% of operations)
- âœ… Realistic error distribution across operation types
- âœ… Proper error tracking and metrics display
- âœ… Command handlers handle business errors gracefully
- âœ… System continues operating under error conditions
- âœ… Load testing reflects real-world failure patterns

## ðŸ”§ Technical Approach
- Add error injection logic to actor methods
- Use probability-based error triggering
- Maintain existing error handling patterns
- Ensure errors don't break simulation flow
- Track both successful and failed operations separately