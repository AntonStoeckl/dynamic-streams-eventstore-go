# PostgreSQL 17.5 Host-Based Authentication for Master with Replication
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections (for Docker container internal use)
local   all             all                                     trust

# Standard database connections from Docker network
host    all             all             127.0.0.1/32            md5
host    all             all             ::1/128                 md5
host    all             all             172.16.0.0/12           md5  # Docker default bridge networks
host    all             all             10.0.0.0/8              md5  # Docker custom networks  
host    all             all             192.168.0.0/16          md5  # Local networks

# Allow connections from Docker Compose network (broad range for flexibility)
host    all             all             0.0.0.0/0               md5

# Replication connections - Critical for PostgreSQL 17.5 Streaming Replication
# Allow replication from replicas in Docker network
host    replication     replicator      172.16.0.0/12           md5  # Docker bridge networks
host    replication     replicator      10.0.0.0/8              md5  # Docker custom networks
host    replication     replicator      192.168.0.0/16          md5  # Local networks

# Allow replication from any Docker container (for Docker Compose flexibility)
host    replication     replicator      0.0.0.0/0               md5

# Additional replication user access (for administrative purposes)
host    replication     all             172.16.0.0/12           md5
host    replication     all             10.0.0.0/8              md5
host    replication     all             192.168.0.0/16          md5

# Allow superuser replication connections (for maintenance and monitoring)
host    replication     postgres        127.0.0.1/32            md5
host    replication     postgres        ::1/128                 md5
host    replication     postgres        0.0.0.0/0               md5